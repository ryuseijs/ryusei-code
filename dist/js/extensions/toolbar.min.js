!function(t,n){"function"==typeof define&&define.amd?define([],n):"undefined"!=typeof exports?n():(n(),t.unknown={})}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(){"use strict";function o(t,n){t.prototype=Object.create(n.prototype),i(t.prototype.constructor=t,n)}function i(t,n){return(i=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function r(t,n){for(var i=0;i<n.length;i++){var o=n[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}
/*!
   * RyuseiCode.js
   * Version  : 0.1.7
   * License  : MIT
   * Copyright: 2021 Naotoshi Fujita
   */
var u="ryuseicode",c=u+"__button",e="is-active";function s(t){return null!==t&&"object"==typeof t}function f(t){return Array.isArray(t)}function h(t){return"string"==typeof t}function a(t){return void 0===t}function l(t,n){return void 0===n&&(n=!1),!f(t)||n&&!f(t[0])?[t]:t}function d(n,t,i){n&&l(t).forEach(function(t){t&&n.classList[i?"add":"remove"](t)})}function v(t,n){d(t,n,!0)}function w(t,n){l(n).forEach(t.appendChild.bind(t))}function b(t,n){if(t)for(var i=Object.keys(t),o=0;o<i.length&&!1!==n(t[i[o]],i[o]);o++);return t}function p(o){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.forEach(function(i){s(i)&&b(i,function(t,n){a(i[n])||(o[n]=i[n])})}),o}function y(i,t){if(i){if(h(t))return i.getAttribute(t);s(t)&&b(t,function(t,n){null===t?i.removeAttribute(n):i.setAttribute(n,String(t))})}}function _(t,n,i){t=document.createElement(t);return n&&(h(n)||f(n)?v:y)(t,n),i&&w(i,t),t}function g(t,n){return _("div",t,n)}var k=new WeakMap;function m(t,n){return t.querySelector(n)}function x(t){l(t).forEach(function(t){t&&t.parentNode&&t.parentNode.removeChild(t)})}function A(t,n){d(t,n,!1)}function j(i,t){if(h(t))return getComputedStyle(i)[t];b(t,function(t,n){a(t)||(i.style[n]=String(t))})}function E(t,n){if(void 0===n&&(n=""),!t)throw new Error("["+u+"] "+n)}var D={Up:"ArrowUp",Down:"ArrowDown",Right:"ArrowRight",Left:"ArrowLeft",Del:"Delete",Esc:"Escape",Spacebar:" "};var H="0 0 24 24";function O(t,n){t=document.createElementNS("http://www.w3.org/2000/svg",t);return y(t,n),t}var S=u+"__toolbar",t=function(r){function t(){return r.apply(this,arguments)||this}o(t,r);var n=t.prototype;return n.listen=function(){r.prototype.listen.call(this),this.on("resize",this.t,this)},n.create=function(){var n,t=this.elements,i=t.root.id+"-toolbar",o=g({id:i,role:"toolbar",class:S}),i=this.createCloseButton({"aria-controls":i});this.n=g("ryuseicode__toolbar__body",o),w(g("ryuseicode__toolbar__ui",o),i),n=t.view,l(o).forEach(function(t){n.insertBefore(t,n.firstChild)}),this.wrapper=o},n.append=function(t){w(this.n,this.groups[t].elm)},n.t=function(){var t;document.documentMode&&this.isActive()&&(t=j(this.elements.root,"maxHeight"),j(this.elements.body,{maxHeight:"calc("+t+" - "+(h(t=this.wrapper.clientHeight)?t:t+"px")+")"}))},n.register=function(t,n,i){v(n,"ryuseicode__toolbar__group"),this.groups[t]={elm:n,label:i}},n.show=function(t){var n=window,i=n.pageXOffset,o=n.pageYOffset,n=this.wrapper;r.prototype.show.call(this,t),this.t(),this.group&&A(n,S+"--"+this.group),v(n,S+"--"+t),y(n,{"aria-label":this.groups[t].label}),this.autoFocus(t),window.scrollTo(i,o),this.View.emitResize(),this.emit("toolbar:opened",this,t)},n.hide=function(){var t=window,n=t.pageXOffset,t=t.pageYOffset;r.prototype.hide.call(this),A(this.wrapper,S+"--"+this.group),j(this.elements.body,{maxHeight:""}),this.Selection.reselect(),window.scrollTo(n,t),this.View.emitResize(),this.emit("toolbar:closed",this,this.group)},t}(function(n){function t(){var t=n.apply(this,arguments)||this;return t.groups={},t}o(t,n);var i=t.prototype;return i.mount=function(t){n.prototype.mount.call(this,t),this.create(),this.listen()},i.create=function(){E(!1)},i.listen=function(){this.bind(window,"keydown",this.escape,this)},i.escape=function(t){var n,i;this.isActive()&&"Escape"===(i=t.key,D[i]||i)&&(this.hide(),(t=t)&&(t.cancelable&&t.preventDefault(),n&&t.stopPropagation()))},i.append=function(t){w(this.wrapper,this.groups[t].elm)},i.autoFocus=function(t){t=this.groups[t].elm,t=m(t,"[tabindex]")||m(t,"input, button");t&&(t.focus(),t instanceof HTMLInputElement&&t.select())},i.createCloseButton=function(t){var n=this.createButtons({id:"close",icon:"close",click:"hide"},null,this).close;return y(n,t),n},i.createButtons=function(t,o,r,u){var e=this,c={};return l(t).forEach(function(n){var t=e.createButton(n,o,u),i=n.click;i&&e.bind(t,"click",function(t){h(i)?r[i]():i(t,e.Editor,n)}),c[n.id]=t},[]),c},i.createButton=function(t,n,i){var o=this.options.i18n,r=t.checkbox,u=t.tabindex,e=t.icon,o=o[t.i18n||t.id];i=[c].concat(e?c+"--icon":null,i);u=_("button",{title:e?o:null,type:"button",tabindex:a(u)?null:u,role:r?"checkbox":null,"aria-checked":r?"false":null,"aria-label":o},n||t.parent);return v(u,i),e?(r=this.options.icons[e])&&w(u,(n=r[0],i=r[1],e=r[2]||"round",r=O("svg",{viewBox:H,class:"ryuseicode__icon"}),n=O("path",{d:n,fill:"currentColor"}),i&&y(n,{"stroke-width":i,"stroke-linecap":e,stroke:"currentColor"}),y(r,{viewBox:H}),r.appendChild(n),r)):function(t,n){if(t){if(a(n))return t.innerHTML;t.innerHTML!==n&&(t.innerHTML=n)}}(u,t.html||o),u},i.createField=function(t,n){var i=this.i18n[t.i18n||t.id],t=t.tabindex;return _("input",{class:"ryuseicode__input",placeholder:i,spellcheck:!1,tabindex:a(t)?null:t,"aria-label":i},n)},i.show=function(t){this.isActive()&&x(this.groups[this.group].elm),v(this.wrapper,e),this.append(t),this.group=t},i.hide=function(){this.isActive()&&(A(this.wrapper,e),x(this.groups[this.group].elm))},i.isActive=function(t){return n=this.wrapper,i=e,n&&n.classList.contains(i)&&(!t||this.group===t);var n,i},i.isFocused=function(){return this.wrapper.contains(document.activeElement)},t}(function(){function t(t){this.Editor=t,this.event=t.event,this.options=t.options,this.language=t.language}var n,i,o=t.prototype;return o.mount=function(t){var i=this;this.elements=t,b(this.Editor.Components,function(t,n){i[n]=t})},o.destroy=function(){!function n(i,t,o){"function"==typeof o?t.split(" ").forEach(function(t){i.removeEventListener(t,o)}):(t=k.get(o))&&(t.forEach(function(t){n(t.elm,t.events,t.callback)}),k.delete(o))}(null,"",this)},o.on=function(t,n,i,o){this.event.on(t,i?n.bind(i):n,this,o)},o.off=function(t){this.event.off(t,this)},o.emit=function(t){for(var n,i=arguments.length,o=new Array(1<i?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];(n=this.event).emit.apply(n,[t].concat(o))},o.bind=function(t,n,i,o){var r,u,e,c;r=t,u=n,e=o?i.bind(o):i,c=this,u.split(" ").forEach(function(t){r.addEventListener(t,e),c&&((t=k.get(c)||[]).push({elm:r,events:u,callback:e}),k.set(c,t))})},o.getLanguage=function(t){t=t||this.Selection.focus;var n=this.language,t=this.lines.getInfoAt(t);return t&&t.language&&n.use&&n.use[t.language]?n.use[t.language].config:n},o.invoke=function(t,n){for(var i,o=arguments.length,r=new Array(2<o?o-2:0),u=2;u<o;u++)r[u-2]=arguments[u];return(i=this.Editor).invoke.apply(i,[t,n].concat(r))},o.require=function(t){return this.Editor.require(t)},o.addIcons=function(t){var n=this.options;n.icons=p({},t,n.icons)},o.addI18n=function(t){var n=this.options;n.i18n=p({},t,n.i18n)},o.addKeyBindings=function(t){var n=this.options;n.keymap=p({},t,n.keymap)},o.getOptions=function(t,n){t=this.options[t];return a(t)||!0===t?n||{}:s(t)?p({},n,t):void E(!1)},n=t,(o=[{key:"lines",get:function(){return this.Code.Lines}},{key:"i18n",get:function(){return this.options.i18n}}])&&r(n.prototype,o),i&&r(n,i),t}()));"undefined"!=typeof window&&window.RyuseiCode&&window.RyuseiCode.compose({Toolbar:t})});
