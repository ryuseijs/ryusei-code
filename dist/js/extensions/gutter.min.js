!function(t,n){"function"==typeof define&&define.amd?define([],n):"undefined"!=typeof exports?n():(n(),t.unknown={})}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(){"use strict";function o(t,n){return(o=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function u(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}
/*!
   * RyuseiCode.js
   * Version  : 0.1.13
   * License  : MIT
   * Copyright: 2021 Naotoshi Fujita
   */
function e(t){return null!==t&&"object"==typeof t}function r(t){return Array.isArray(t)}function s(t){return"string"==typeof t}function f(t){return void 0===t}function h(t,n){return void 0===n&&(n=!1),!r(t)||n&&!r(t[0])?[t]:t}var c=Array.prototype;function a(n,t,i){n&&h(t).forEach(function(t){t&&n.classList[i?"add":"remove"](t)})}function v(t,n){a(t,n,!0)}function d(t,n){if(t)for(var i=Object.keys(t),r=0;r<i.length&&!1!==n(t[i[r]],i[r]);r++);return t}function l(r){for(var t=arguments.length,n=new Array(1<t?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.forEach(function(i){e(i)&&d(i,function(t,n){f(i[n])||(r[n]=i[n])})}),r}function p(t,n,i){t=document.createElement(t);return n&&(s(n)||r(n)?v:function(i,t){if(i){if(s(t))return i.getAttribute(t);e(t)&&d(t,function(t,n){null===t?i.removeAttribute(n):i.setAttribute(n,String(t))})}})(t,n),i&&(i=i,h(t).forEach(i.appendChild.bind(i))),t}var y=new WeakMap;function g(t,n){return t.querySelector(n)}function w(t,n,i){return"<"+(i||"div")+" "+(t=l(n=void 0===n?{}:n,{class:h(t).filter(Boolean).join(" ")}),r="",d(t,function(t,n){n&&(t||!1===t||0===t)&&(r+=" "+n+'="'+t+'"')}),r.trim())+">";var r}function M(t,n){if(t){if(f(n))return t.textContent;t.textContent=n}}var _="ryuseicode";var b=Math.min,k=(Math.max,Math.floor);Math.ceil,Math.abs,Math.round;var m="is-active",S="initStyle",j=_+"__gutter",A=j+"__float",L=j+"__row",O=j+"__number",H={selectLine:!0,start:1,sticky:!0},t=function(r){var t;function n(t){var i=r.call(this,t)||this;return i.t=i.getOptions("gutter",H),i.n=i.t.start,i.on(S,function(t,n){n("."+j,"fontFamily",i.options.monospaceFont)}),i.i(),i}i=r,(t=n).prototype=Object.create(i.prototype),o(t.prototype.constructor=t,i);var i=n.prototype;return i.i=function(){var o=this;this.on("root:open",function(t,n,i){i.push("has-gutter")}),this.on("editor:open",function(t,n,i,r){n(w([j,o.t.sticky?"ryuseicode__gutter--sticky":""],{"aria-hidden":!0})),n(w(A)),n(o.r(r,n)),n(function(t,n){if(String.prototype.repeat)return t.repeat(n);for(var i="";0<n;)n%2&&(i+=t),n=k(n/2),t+=t;return i}("</div>",2))}),this.on(S,function(t,n){var i=o.options.lineHeight;n("."+L,{height:i?i+"em":void 0,lineHeight:i})})},i.r=function(t,n){for(var i=[],r=b(t.length,this.options.maxInitialLines)+1,o=0;o<r;o++){var u=(o===r-1?t.length-1:o)+this.n;n(w(L)),n('<span class="'+O+'">'+u+"</span>"),this.emit("gutter:row",i,o,u),n("</div>")}return i.join("")},i.mount=function(t){var n,i;r.prototype.mount.call(this,t),this.o=g(t.root,"."+j),this.u=g(this.o,"."+A),this.o&&(n=this.u.children,0<(t=this.Chunk.length-n.length)?this.e(t):t<0&&h(c.slice.call(n,t,i)).forEach(function(t){t&&t.parentNode&&t.parentNode.removeChild(t)}),this.s(),this.f())},i.e=function(t){for(var n,i=0;i<t;i++)p("span",O,(n=this.u,p("div",L,n)))},i.s=function(){var r=this;this.on("chunkSupplied",function(t,n,i){r.e(i)}),this.on(["chunkMoved","scrollHeightChanged","resize"],this.f,this),this.on("activeLine:updated",this.h,this),this.on("activeLine:deactivated",this.c,this),this.t.selectLine&&this.bind(this.o,"pointerdown",this.a,this)},i.a=function(t){var n,i,r,o=t.target;o instanceof HTMLElement&&(r=O,(i=o)&&i.classList.contains(r))&&(o=+M(o),isNaN(o)||(this.Selection.selectLine(o-this.n,!0,!0),(t=t)&&(t.cancelable&&t.preventDefault(),n&&t.stopPropagation())))},i.f=function(){for(var t,n,i,r,o=this.Chunk.start,u=this.n,e=this.lines.length,s=this.u.children,f=0;f<s.length;f++){var h=s[f],c=(f===s.length-1?e-1:o+f)+u;M(h.firstChild,(t=c,i=e+(n=u)-1,h=r=void 0,h=Math.min(n,i),i=Math.max(n,i),(r?h<t&&t<i:h<=t&&t<=i)?""+c:""))}this.v(),this.h()},i.v=function(){var t;!function(i,t){if(s(t))return getComputedStyle(i)[t];d(t,function(t,n){f(t)||(i.style[n]=String(t))})}(this.u,{top:s(t=this.Chunk.offsetY)?t:t+"px"})},i.h=function(){var t=this.Selection.focus[0],t=this.d(t);this.c(),t&&this.Editor.isFocused()&&(v(t,m),this.l=t,this.emit("gutter:activated",t))},i.c=function(){var t=this.l;t&&(a(t,m,!1),this.emit("gutter:deactivated",t),this.l=null)},i.d=function(t){return-1<t?this.u.children[t-this.Chunk.start]:void 0},n}(function(){function t(t){this.Editor=t,this.event=t.event,this.options=t.options,this.language=t.language}var n,i,r=t.prototype;return r.mount=function(t){var i=this;this.elements=t,d(this.Editor.Components,function(t,n){i[n]=t})},r.destroy=function(){!function n(i,t,r){"function"==typeof r?t.split(" ").forEach(function(t){i.removeEventListener(t,r)}):(t=y.get(r))&&(t.forEach(function(t){n(t.elm,t.events,t.callback)}),y.delete(r))}(null,"",this)},r.on=function(t,n,i,r){this.event.on(t,i?n.bind(i):n,this,r)},r.off=function(t){this.event.off(t,this)},r.emit=function(t){for(var n,i=arguments.length,r=new Array(1<i?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];(n=this.event).emit.apply(n,[t].concat(r))},r.bind=function(t,n,i,r){var o,u,e,s;o=t,u=n,e=r?i.bind(r):i,s=this,u.split(" ").forEach(function(t){o.addEventListener(t,e),s&&((t=y.get(s)||[]).push({elm:o,events:u,callback:e}),y.set(s,t))})},r.getLanguage=function(t){t=t||this.Selection.focus;var n=this.language,t=this.lines.getInfoAt(t);return t&&t.language&&n.use&&n.use[t.language]?n.use[t.language].config:n},r.invoke=function(t,n){for(var i,r=arguments.length,o=new Array(2<r?r-2:0),u=2;u<r;u++)o[u-2]=arguments[u];return(i=this.Editor).invoke.apply(i,[t,n].concat(o))},r.require=function(t){return this.Editor.require(t)},r.addIcons=function(t){var n=this.options;n.icons=l({},t,n.icons)},r.addI18n=function(t){var n=this.options;n.i18n=l({},t,n.i18n)},r.addKeyBindings=function(t){var n=this.options;n.keymap=l({},t,n.keymap)},r.getOptions=function(t,n){t=this.options[t];return f(t)||!0===t?n||{}:e(t)?l({},n,t):void function(t,n){if(void 0===n&&(n=""),!t)throw new Error("["+_+"] "+n)}(!1)},n=t,(r=[{key:"lines",get:function(){return this.Code.Lines}},{key:"i18n",get:function(){return this.options.i18n}}])&&u(n.prototype,r),i&&u(n,i),t}());"undefined"!=typeof window&&window.RyuseiCode&&window.RyuseiCode.compose({Gutter:t})});
